# Custom Jupyter Notebook kernel setup

Based on [this issue](https://github.com/jupyterhub/jupyterhub/issues/847)

This repo is a first draft of a solution to the following problem :

* How do I set up a custom runtime environment for my ipython jupyter kernel?

Maybe I need to set environment custom environment variables, modify my *PYTHONPATH*, ensure certain packages are installed, ensure certain files are in the proper location, etc.

However, what I do not want to do is manually run through this kind of checklist everytime I start a new notebook. This kind of setup should be automated. Also, it should be independent of the directory from which I start my jupyter notebook server.

This repo attemps to provide a minimal working example of a solution.

NOTE: Running the solution currently requires you to have **jq** installed.

The solution consists of several steps :

* Running the setupkernel.sh script by running
    `./setupkernel.sh CUSTOM_KERNEL_NAME`
  
  This installs a new IPython-derived Jupyter Notebook kernel for the user running *setupkernel.sh*.
  
  Furthermore, it sets up this new custom kernel in such a way that, before the IPython interperter
  is started, a bash script, called kernelstart.sh is run. Use this script to specify how your kernel
  environment should be modified.

* The *kernel.json* file, generated by *setupkernel.sh* from *kernel.json.template*, is copied into the appropriate location
  so that it is accessible to the local instalation of jupyter

The consequence of these two steps is that the next time you start a jupyter notebook server by running
  `jupyter notebook`
from any location, a new kernel, called *CUSTOM_KERNEL_NAME*, will be accessible from the "New" dropdown menu
when opening a new notebook.

In contrast to the plain Python2 or Python3 kernels, this new custom kernel will have the environment set up according to
the commands in *kernelstart.sh*.

In this particular example, we have set up a *./notebooks* directory that will contain Jupyter notebooks, as well as a *./src*
which is to contain source code that, for example, we would like to have accessible when working in one of our notebooks.

For this reason, *kernelstart.sh* appends the *./src* directory to the *PYTHONPATH*. Because of this, we are able to run

`from data import load`
`from models import logreg`

regardless of where we started the jupyter notebook server from, or where the actual notebook is located.